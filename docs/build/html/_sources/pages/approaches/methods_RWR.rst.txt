.. _RWR:

==================================================
Random Walk with Restart
==================================================

Principle
------------

.. note::

    The Random Walk is performed using multiXrank [1]_ --
    :octicon:`mark-github;1em` `GitHub <https://github.com/anthbapt/multixrank>`_ :octicon:`book;1em` `ReadTheDocs <https://multixrank-doc.readthedocs.io/en/latest/>`_

This method measures the **proximity** of every gene within a multilayer to the target genes. Every gene from the list is
define as a **seed**. The walk starts with a seed, selected **randomly**. The proximity is represented by a score that could be use
for multiple analyse. More the score is high, more the node is closed to the seed.

It's a kind of **diffusion analysis** from the genes through different molecular interactions (:numref:`overviewFig` - right part).

*For more details, see the paper* [1]_

Usage
-------

By default, data are extracted directly by request databases (:numref:`RWRUsageFig`: *data extracted from requests*).
You give the ``--chemicalsFile`` and the **target genes** are extracted from **CTD**.

You can provide your own **target genes file** (:numref:`RWRUsageFig`: *data extracted from users*) with ``--targetGenesFile``.

.. _RWRUsageFig:
.. figure:: ../../pictures/multixrank_graph.png
    :alt: RWR analysis
    :align: center

    : Input and output files of Random Walk with Restart analysis

    There is two ways to extract target genes : from request (pink boxes) or provided by the user (green boxes).
    Required files/parameters have solid border line and optional files/parameters have dash border line.
    Output files in pink are created only if the input data are extracted from requests.

Input parameters for RWR analysis
----------------------------------------

To extract target genes from **CTD**, see parameters on the ``Data extracted from requests`` tab.
To provide **your own** target genes, see parameters on the ``Data extracted from user`` tab.

.. tabs::

    .. group-tab:: Data extracted from requests

        -c, --chemicalsFile FILENAME
            Contains a list of chemicals. They have to be in **MeSH** identifiers (e.g. D014801).
            You can give several chemicals in the same line : they will be grouped for the analysis.
            [:ref:`FORMAT <chemicalsFile>`] **[required]**

        --directAssociation BOOLEAN
            | ``TRUE`` : extract chemicals data, which are in the chemicalsFile, from CTD
            | ``FALSE``: extract chemicals and their child molecules data from CTD
            | ``[default: True]``

        --nbPub INTEGER
            References can be associated with chemical interactions.
            You can define a threshold to filter target genes extraction based on the number of publications.
            ``[default: 2]``

    .. group-tab:: Data extracted from user

        -t, --targetGenesFile FILENAME
            Contains a list of target genes. One gene per line. [:ref:`FORMAT <genesList>`]
            **[required]**

--configPath PATH
    MultiXrank needs a configuration file. It could be short (only file names) or very details (file names + parameters).
    The file contains at least paths of networks, bipartite and seed files. **[required]**

    | For more details : [:ref:`FORMAT <configFile>`] - :octicon:`mark-github;1em` `GitHub <https://github.com/anthbapt/multixrank>`_ :octicon:`book;1em` `ReadTheDocs <https://multixrank-doc.readthedocs.io/en/latest/>`_

--networksPath PATH
    Repository path where networks are saved. **[required]**

--seedsFile FILENAME
    Path name file to store seed list. This file contains the list of genes (i.e. target genes). They will be used as seed
    on the Random Walk analysis. [:ref:`FORMAT <simpleFile>`] **[required]**

--sifFileName FILENAME
    Output file name to save the result into a SIF file. **[required]**

--top INTEGER
    Top nodes that will be saved into the output network (into SIF file).

-o, --outputPath PATH
    Name of the folder where to save the results.
    ``[default: OutputResults]``

Use-cases command line
------------------------

.. tabs::

    .. group-tab:: Data extracted from requests

        .. code-block:: bash

            python3 main.py multixrank  --chemicalsFile useCases/InputData/chemicalsFile.csv \
                                        --directAssociation FALSE \
                                        --nbPub 2 \
                                        --configPath useCases/InputData/config_minimal_useCase1.yml \
                                        --networksPath useCases/InputData/ \
                                        --seedsFile useCases/InputData/seeds.txt \
                                        --sifFileName resultsNetwork_useCase1.sif \
                                        --top 10 \
                                        --outputPath useCases/OutputResults_useCase1/

    .. group-tab:: Data extracted from user

        .. code-block:: bash

            python3 main.py multixrank  --targetGenesFile useCases/InputData/VitA-Balmer2002-Genes.txt \
                                        --configPath useCases/InputData/config_minimal_useCase2.yml \
                                        --networksPath useCases/InputData/ \
                                        --seedsFile useCases/InputData/seeds.txt \
                                        --sifFileName resultsNetwork_useCase2.sif \
                                        --top 10 --outputPath \
                                        --outputPath useCases/OutputResults_useCase2/

Networks available
--------------------

.. note::

    We use the biological multilayer network from multiXrank's paper [1]_.

We propose to run two walks through two different network compositions :

- molecular multilayer with three layers + pathways of interest network (:numref:`RWRFig` - left part)
- molecular multilayer with three layers + disease-disease similarity network (:numref:`RWRFig` - right part)

.. _RWRFig:
.. figure:: ../../pictures/NetworkAvailable_RWR.png
    :alt: RWR networks
    :align: center

    : Random Walk into two different network compositions

Molecular multilayer
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Details of layers (number of nodes, edges, nature of association and source).

.. _disconnectedDiseases:

Pathways of interest network
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This kind of network can be build using the ``networkCreation`` method.

By default, the network is build using Rare Diseases pathways extracted automatically from WP.

--networksPath PATH
    Output repository name where the pathways network will be saved.

--bipartitePath PATH
    Output repository name where the bipartite gene-pathway will be saved.

--networksName FILENAME
    You can give a name to the pathway network. It's a SIF file but each pathway of interest is link to itself.
    ``[default: WP_RareDiseasesNetwork.sif]``

--bipartiteName FILENAME
    You can give a name to the bipartite. It's a tab-separated file.
    ``[default: Bipartite_WP_RareDiseases_geneSymbols.tsv]``

-o, --outputPath PATH
    Name of the folder where to save complementary results (i.e. request results)
    ``[default: OutputResults]``

Moreover, you can provide your own pathways/processes of interest file using ``--GMT`` parameter.

This kind of network can be build from Rare Diseases pathways (WP) or from your own pathways/processes of interest
with ``networkCreation`` method.

.. tabs::

    .. group-tab:: Data extracted from requests

        .. code-block:: bash

            python3 main.py

    .. group-tab:: Data extracted from user

        .. code-block:: bash

            python3 main.py

.. _DDnet:

Disease-disease similarity network
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Disease-disease similarity network creation
""""""""""""""""""""""""""""""""""""""""""""""

We constructed a disease-disease network based on the phenotype similarity between diseases. A disease is
a set of phenotype and each phenotype is associated to the Human Ontology Project IDs (HPO).

The similarity score is calculated based on the number of shared phenotypes between two diseases ([3]_, [2]_, [1]_).
Every pairs of diseases will have a score, so for each disease we selected the top 5 of the most similar disease.

.. tip::

    | You can use any multilayer and networks that you want.
    | :octicon:`alert;1em` Be careful with the configuration file and the gene IDs used

Annotation come from HPO (`website <https://hpo.jax.org/app/download/annotation>`) and ontology come from HPO too (
`website <https://hpo.jax.org/app/download/ontology>`.

33 925 edges and 8 264 diseases

Gene-disease bipartite associations
"""""""""""""""""""""""""""""""""""""

The multiplex network is connected to the disease-disease similarity network with the gene-disease bipartite creating using
association file from HPO (`website <https://hpo.jax.org/app/download/annotation>`).

6 564 associations (4 483 genes and 5 878 diseases)



References
------------

.. [1] Baptista, A., Gonzalez, A., & Baudot, A. (2022). Universal multilayer network exploration by random walk with restart. Communications Physics, 5(1), 1-9.
.. [2] Valdeolivas, A., Tichit, L., Navarro, C., Perrin, S., Odelin, G., Levy, N., ... & Baudot, A. (2019). Random walk with restart on multiplex and heterogeneous biological networks. Bioinformatics, 35(3), 497-505.
.. [3] Westbury SK, Turro E, Greene D, Lentaigne C, Kelly AM, Bariana TK, Simeoni I, Pillois X, Attwood A, Austin S, Jansen SB, Bakchoul T, Crisp-Hihn A, Erber WN, Favier R, Foad N, Gattens M, Jolley JD, Liesner R, Meacham S, Millar CM, Nurden AT, Peerlinck K, Perry DJ, Poudel P, Schulman S, Schulze H, Stephens JC, Furie B, Robinson PN, van Geet C, Rendon A, Gomez K, Laffan MA, Lambert MP, Nurden P, Ouwehand WH, Richardson S, Mumford AD, Freson K; BRIDGE-BPD Consortium. Human phenotype ontology annotation and cluster analysis to unravel genetic defects in 707 cases with unexplained bleeding and platelet disorders. Genome Med. 2015 Apr 9;7(1):36. doi: 10.1186/s13073-015-0151-5. PMID: 25949529; PMCID: PMC4422517.