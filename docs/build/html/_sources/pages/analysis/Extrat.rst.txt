***** EXTRACT *****

In this use-case, we propose to use two different multilayer networks:

The third approach, Random Walk with Restart (RWR), is applied into two different networks compositions:

1. Multilayer network with three molecular layers + rare disease pathways network connected to nodes
2. Multilayer network with three molecular layers + disease-disease similarity network linked with a bipartite

The RWR is performed using multiXrank.



Running Random Walk analysis with data retrieved automatically from databases
--------------------------------------------------------------------------------

| To know how to create the rare disease pathways network: see :ref:`pathwaysOfInterestNet`.
| To know how to create the disease-disease similarity network: see :ref:`DDnet`.

Whatever the network used, we want to extract target genes of vitamin A and its descendant chemicals (``--directAssociation False``).
The **chemicalsFile.csv** file [:ref:`FORMAT <chemicalsFile>`] contains the MeSH ID of vitamin A.
Then, we keep vitamin-gene interaction with at least 2 associated publications (``--nbPub 2``).

MultiXrank needs a configuration file (``--configPath``) and the networks path (``--networksPath``). We run the analysis with
default parameters.

The target genes are set as seeds for the walk and saved into a file ``--seedsFile examples/InputData/seeds.txt``.
You need to give the SIF file name (``--sifFileName``) to save the top nodes based on the score calculated by the RWR (``--top 10``).

Results files are saved into ``useCases/OutputResults_useCase1/`` folder.

.. cssclass:: italic

    If you need more details about the input format files, see :ref:`GR` and :ref:`configFile` parts.

.. tip::

    Whatever the networks used, the **command line is the same**. But you have to **change** the network name inside the
    **configuration file**.

    .. tabs::

        .. group-tab:: Rare disease pathways network

            .. code-block:: bash
                :emphasize-lines: 9,11

                 multiplex:
                     1:
                         layers:
                             - multiplex/1/Complexes_Nov2020.gr
                             - multiplex/1/PPI_Jan2021.gr
                             - multiplex/1/Reactome_Nov2020.gr
                     2:
                         layers:
                             - multiplex/2/WP_RareDiseasesNetwork_fromRequest.sif
                 bipartite:
                     bipartite/Bipartite_WP_RareDiseases_geneSymbols_fromRequest.tsv:
                         source: 2
                         target: 1
                 seed:
                     seeds.txt

        .. group-tab:: Disease-Disease similarity network

            .. code-block:: bash
               :emphasize-lines: 9,11

                multiplex:
                    1:
                        layers:
                            - multiplex/1/Complexes_Nov2020.gr
                            - multiplex/1/PPI_Jan2021.gr
                            - multiplex/1/Reactome_Nov2020.gr
                    2:
                        layers:
                            - multiplex/2/DiseaseSimilarity_network_2022_06_11.txt
                bipartite:
                    bipartite/Bipartite_genes_to_OMIM_2022_09_27.txt:
                        source: 2
                        target: 1
                seed:
                    seeds.txt


.. code-block:: bash

    odamnet multixrank  --chemicalsFile useCases/InputData/chemicalsFile.csv \
                                --directAssociation FALSE \
                                --nbPub 2 \
                                --configPath useCases/InputData/config_minimal_useCase1.yml \
                                --networksPath useCases/InputData/ \
                                --seedsFile useCases/InputData/seeds.txt \
                                --sifFileName resultsNetwork_useCase1.sif \
                                --top 10 \
                                --outputPath useCases/OutputResults_useCase1/

Several files are generated:

- ``CTD_request_D014801_2022_09_07.tsv`` and ``CTD_requestFiltered_D014801_2022_09_07.tsv``:
  the first file contains **results from CTD** request and the second one contains the filtered (by publications number) results.

- ``RWR_D014801/`` folder with the walk results:

    - ``config_minimal_useCase1.yml`` and ``seeds.txt``: copies of the input files

    - ``multiplex_1.tsv`` and ``multiplex_2.tsv``: score for each feature. 1 corresponds to the multiplex network  and 2 to
      the rare disease pathways network (depends of the network folder name).

    - ``resultsNetwork_useCase1.sif``: SIF file name that contains the network result

.. cssclass:: italic

    For more details about these file, see :doc:`../formats/Output` page.


We use the default parameters, whatever the networks used.

*In this part, we present results found for the first multilayer network composition: multiplex network + rare disease pathways network.*

First, multiXrank uses target genes as *seeds* to start the walk. Over 1,988 target genes are used over 2,143 retrieved
target genes.

The gene with the highest score is ``VCAM1`` with ``score = 0.0002083975629882177`` (it's a seed). This score helps
us to select a list of pathways. All pathways with a score bigger than this score are extracted and considered as connected
with target genes (i.e. seeds).

According this highest score, **27 pathways** are selected (:ref:`Table 11 <useCase1_pathwaysRWR>`).

.. _useCase1_pathwaysRWR:
.. table:: Pathways linked to target genes
    :align: center

    +------------+-----------------------------------------------------+--------------+
    | node       | pathways                                            | score        |
    +============+=====================================================+==============+
    | WP5087     | Malignant pleural mesothelioma                      | 0.002871     |
    +------------+-----------------------------------------------------+--------------+
    | WP4673     | Male infertility                                    | 0.000868     |
    +------------+-----------------------------------------------------+--------------+
    | WP5124     | Alzheimer's disease                                 | 0.000775     |
    +------------+-----------------------------------------------------+--------------+
    | WP2059     | Alzheimer's disease and miRNA effects               | 0.000775     |
    +------------+-----------------------------------------------------+--------------+
    | WP4298     | Acute viral myocarditis                             | 0.000731     |
    +------------+-----------------------------------------------------+--------------+
    | WP4746     | Thyroid hormones production and peripheral ...      | 0.000622     |
    +------------+-----------------------------------------------------+--------------+
    | WP3584     | MECP2 and associated Rett syndrome                  | 0.000601     |
    +------------+-----------------------------------------------------+--------------+
    | WP5224     | 2q37 copy number variation syndrome                 | 0.000567     |
    +------------+-----------------------------------------------------+--------------+
    | WP4549     | Fragile X syndrome                                  | 0.000555     |
    +------------+-----------------------------------------------------+--------------+
    | WP4657     | 22q11.2 copy number variation syndrome              | 0.000522     |
    +------------+-----------------------------------------------------+--------------+
    | WP4541     | Hippo-Merlin signaling dysregulation                | 0.000521     |
    +------------+-----------------------------------------------------+--------------+
    | WP4932     | 7q11.23 copy number variation syndrome              | 0.000492     |
    +------------+-----------------------------------------------------+--------------+
    | **WP5053** | **Development of ureteric collection system**       | **0.000454** |
    +------------+-----------------------------------------------------+--------------+
    | WP4949     | 16p11.2 proximal deletion syndrome                  | 0.000442     |
    +------------+-----------------------------------------------------+--------------+
    | WP5114     | Nucleotide excision repair in xeroderma pigmentosum | 0.000394     |
    +------------+-----------------------------------------------------+--------------+
    | WP4312     | Rett syndrome causing genes                         | 0.000393     |
    +------------+-----------------------------------------------------+--------------+
    | WP2447     | Amyotrophic lateral sclerosis (ALS)                 | 0.000384     |
    +------------+-----------------------------------------------------+--------------+
    | WP4879     | Overlap between signal transduction pathways ...    | 0.000328     |
    +------------+-----------------------------------------------------+--------------+
    | WP4906     | 3q29 copy number variation syndrome                 | 0.000305     |
    +------------+-----------------------------------------------------+--------------+
    | WP4540     | Hippo signaling regulation pathways                 | 0.000303     |
    +------------+-----------------------------------------------------+--------------+
    | WP5222     | 2q13 copy number variation syndrome                 | 0.000284     |
    +------------+-----------------------------------------------------+--------------+
    | WP3995     | Prion disease pathway                               | 0.000280     |
    +------------+-----------------------------------------------------+--------------+
    | WP3998     | Prader-Willi and Angelman syndrome                  | 0.000247     |
    +------------+-----------------------------------------------------+--------------+
    | WP4803     | Ciliopathies                                        | 0.000244     |
    +------------+-----------------------------------------------------+--------------+
    | WP2371     | Parkinson's disease pathway                         | 0.000231     |
    +------------+-----------------------------------------------------+--------------+
    | **WP4823** | **Genes controlling nephrogenesis**                 | **0.000221** |
    +------------+-----------------------------------------------------+--------------+
    | WP4545     | Oxysterols derived from cholesterol                 | 0.000214     |
    +------------+-----------------------------------------------------+--------------+

Two pathways related to CAKUT disease are found: WP5053 and WP4823. You can visualise the results with a network as
shown on the :numref:`useCase1_orsum`.

.. _useCase1_pathwaysNetworkRWR:
.. figure:: ../../pictures/RWR_pathwaysNet_useCase1.png
   :alt: usecase 1 pathwaysNetworkRWR
   :align: center

   : Results from RWR through the multiplex network and rare disease pathways network

    Disease pathways are represented by triangle nodes in pink, genes are represented by white nodes and target genes by grey nodes.

awk -F"\t" 'NR==FNR{a[$1]; next} {if($1 in a){print $1"\t"$2}}' RWR_top20.txt ../../OutputOverlapResults/WP_RareDiseases_request_2022_09_07.gmt

awk -F"\t" 'NR==FNR{a[$1]; next} {if($1 in a){print $1"\t"$2}}' RWR_top20.txt ../../../../../DiseaseNetworks/hpo_disease_net/00_Data/phenotype_2022_06_11_diseaseNames.hpoa > diseasesDescription.txt